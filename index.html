<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HealthCheck Pro - Professional Clinical Data</title>
    <style>
        :root {
            --primary: #0081a7; 
            --primary-dark: #005f73;
            --accent: #00afb9;
            --bg-gradient: linear-gradient(135deg, #fdfbf7 0%, #eef2f3 100%);
            --card-bg: #ffffff;
            --text-main: #2b2d42;
            --text-muted: #8d99ae;
            --success: #38b000;
            --warning: #ffaa00;
            --danger: #d00000;
            --radius: 12px;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-gradient);
            color: var(--text-main);
            line-height: 1.6;
            padding: 40px 10px;
        }

        .container { max-width: 1200px; margin: 0 auto; }
        header { text-align: center; margin-bottom: 50px; }
        header h1 { font-weight: 800; font-size: 2.8rem; color: var(--primary-dark); }
        
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 30px; }

        .card {
            background: var(--card-bg);
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow);
            border: 1px solid #edf2f7;
            display: flex;
            flex-direction: column;
        }

        .card h2 { font-size: 1.3rem; margin-bottom: 20px; color: var(--primary-dark); border-bottom: 2px solid #f7fafc; padding-bottom: 10px; }
        
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-size: 0.85rem; font-weight: 700; color: var(--text-muted); }
        
        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.2s;
        }

        input:focus { border-color: var(--primary); outline: none; }

        button {
            width: 100%;
            padding: 14px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            margin-top: 10px;
            transition: background 0.2s;
        }

        button:hover { background-color: var(--primary-dark); }
        button.outline { background: transparent; border: 1px solid var(--primary); color: var(--primary); }

        .result-box {
            margin-top: 20px;
            padding: 15px;
            background: #f7fafc;
            border-radius: 8px;
            border-left: 5px solid var(--accent);
            display: none;
        }

        .result-value { font-size: 1.8rem; font-weight: 800; }
        .result-desc { font-size: 0.95rem; color: var(--text-muted); }

        #tap-area {
            height: 120px;
            border: 2px dashed #cbd5e1;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            background: #f8fafc;
            margin-bottom: 15px;
            font-weight: bold;
            color: var(--text-muted);
            user-select: none;
        }

        .timer-display { font-family: monospace; font-size: 2.2rem; text-align: center; margin: 15px 0; color: var(--primary-dark); }
        .hidden { display: none; }
        
        footer { margin-top: 60px; text-align: center; font-size: 0.85rem; color: var(--text-muted); padding: 20px; border-top: 1px solid #e2e8f0; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>HealthCheck Pro</h1>
        <p>Zaawansowana analityka medyczna i wska≈∫niki antropometryczne.</p>
    </header>

    <div class="grid">
        
        <div class="card">
            <h2><span class="card-icon">‚öñÔ∏è</span> BMI (Siatki Centylowe)</h2>
            <div class="form-group">
                <label>Grupa wiekowa</label>
                <select id="bmi-group" onchange="toggleAgeGroup()">
                    <option value="adult">Doros≈Çy (20+ lat)</option>
                    <option value="minor">Dziecko / Nastolatek (5-19 lat)</option>
                </select>
            </div>
            <div id="minor-fields" class="hidden">
                <div class="form-group">
                    <label>P≈Çeƒá</label>
                    <select id="bmi-gender">
                        <option value="male">Ch≈Çopiec</option>
                        <option value="female">Dziewczynka</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Dok≈Çadny wiek (lat)</label>
                    <input type="number" id="bmi-age-val" placeholder="np. 12">
                </div>
            </div>
            <div class="form-group">
                <label>Waga (kg)</label>
                <input type="number" id="bmi-weight" step="0.1">
            </div>
            <div class="form-group">
                <label>Wzrost (cm)</label>
                <input type="number" id="bmi-height">
            </div>
            <button onclick="calculateBMI()">Oblicz Wska≈∫nik</button>
            <div id="res-bmi" class="result-box"></div>
        </div>

        <div class="card">
            <h2><span class="card-icon">üìè</span> WHR (Rozk≈Çad t≈Çuszczu)</h2>
            <div class="form-group">
                <label>P≈Çeƒá</label>
                <select id="whr-gender">
                    <option value="m">Mƒô≈ºczyzna</option>
                    <option value="k">Kobieta</option>
                </select>
            </div>
            <div class="form-group"><label>Obw√≥d talii (cm)</label><input type="number" id="whr-waist"></div>
            <div class="form-group"><label>Obw√≥d bioder (cm)</label><input type="number" id="whr-hip"></div>
            <button onclick="calculateWHR()">Oblicz WHR</button>
            <div id="res-whr" class="result-box"></div>
        </div>

        <div class="card">
            <h2><span class="card-icon">üî•</span> BMR (Zapotrzebowanie)</h2>
            <div class="form-group">
                <label>P≈Çeƒá</label>
                <select id="bmr-gender">
                    <option value="m">Mƒô≈ºczyzna</option>
                    <option value="k">Kobieta</option>
                </select>
            </div>
            <div style="display:flex; gap:10px">
                <div class="form-group"><label>Waga (kg)</label><input type="number" id="bmr-weight"></div>
                <div class="form-group"><label>Wzrost (cm)</label><input type="number" id="bmr-height"></div>
                <div class="form-group"><label>Wiek</label><input type="number" id="bmr-age"></div>
            </div>
            <button onclick="calculateBMR()">Oblicz Mifflin-St Jeor</button>
            <div id="res-bmr" class="result-box"></div>
        </div>

        <div class="card">
            <h2><span class="card-icon">‚ù§Ô∏è</span> Pulsometr (Manualny)</h2>
            <p style="font-size:0.8rem; margin-bottom:10px;">Instrukcja: Klikaj w pole poni≈ºej zgodnie z uderzeniami serca przez minimum 5 sekund.</p>
            <div id="tap-area" onclick="handleTap()">
                <span>KLIKAJ TUTAJ</span>
                <small id="tap-count">Taps: 0</small>
            </div>
            <div class="result-value" id="bpm-display" style="text-align:center">-- BPM</div>
            <button class="outline" onclick="resetPulse()">Reset licznika</button>
        </div>

        <div class="card">
            <h2><span class="card-icon">üßç</span> WHtR (Talia/Wzrost)</h2>
            <div class="form-group"><label>Obw√≥d talii (cm)</label><input type="number" id="whtr-waist"></div>
            <div class="form-group"><label>Wzrost (cm)</label><input type="number" id="whtr-height"></div>
            <button onclick="calculateWHtR()">Sprawd≈∫ Ryzyko</button>
            <div id="res-whtr" class="result-box"></div>
        </div>

        <div class="card">
            <h2><span class="card-icon">üíß</span> Nawodnienie</h2>
            <div class="form-group"><label>Waga cia≈Ça (kg)</label><input type="number" id="h2o-weight"></div>
            <div class="form-group"><label>Aktywno≈õƒá (minuty treningu)</label><input type="number" id="h2o-act" value="0"></div>
            <button onclick="calculateWater()">Oblicz ml/dzie≈Ñ</button>
            <div id="res-h2o" class="result-box"></div>
        </div>

        <div class="card" style="grid-column: 1 / -1;">
            <h2><span class="card-icon">üèÉ</span> Test Ruffiera (Wydolno≈õƒá KrƒÖ≈ºeniowa)</h2>
            <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap:20px;">
                <div>
                    <div class="timer-display" id="r-timer">00:45</div>
                    <button class="outline" onclick="startRuffierTimer(45)">Start: Przysiady (45s)</button>
                    <button class="outline" style="margin-top:10px" onclick="startRuffierTimer(60)">Start: Odpoczynek (60s)</button>
                </div>
                <div>
                    <div class="form-group"><label>P1 (Puls spoczynkowy)</label><input type="number" id="r-p1"></div>
                    <div class="form-group"><label>P2 (Puls po 30 przysiadach)</label><input type="number" id="r-p2"></div>
                    <div class="form-group"><label>P3 (Puls po 1 min odpoczynku)</label><input type="number" id="r-p3"></div>
                    <button onclick="calculateRuffier()">Oblicz Indeks Ruffiera</button>
                </div>
            </div>
            <div id="res-ruffier" class="result-box"></div>
        </div>

    </div>

    <footer>
        <p>Wzory: BMI (Quetelet), BMR (Mifflin-St Jeor 1990), WHR/WHtR (WHO Standards), Indeks Ruffiera-Dicksona.<br>
        Dane dla dzieci estymowane na podstawie tabel centylowych WHO 2007 (5-19 lat).</p>
    </footer>
</div>

<script>
    /* POMOCNICZE */
    function show(id, val, desc, color) {
        const el = document.getElementById(id);
        el.style.display = 'block';
        el.style.borderLeftColor = color;
        el.innerHTML = `<div class="result-value" style="color:${color}">${val}</div><div class="result-desc">${desc}</div>`;
    }

    /* 1. BMI ZAWANSOWANE */
    function toggleAgeGroup() {
        const isMinor = document.getElementById('bmi-group').value === 'minor';
        document.getElementById('minor-fields').classList.toggle('hidden', !isMinor);
    }

    function calculateBMI() {
        const group = document.getElementById('bmi-group').value;
        const w = parseFloat(document.getElementById('bmi-weight').value);
        const h = parseFloat(document.getElementById('bmi-height').value) / 100;
        if (!w || !h) return;

        const bmi = (w / (h * h)).toFixed(2);
        let desc = "", col = "";

        if (group === 'adult') {
            if (bmi < 18.5) { desc = "Niedowaga"; col = "#3182ce"; }
            else if (bmi < 25) { desc = "Norma (W≈Ça≈õciwa masa cia≈Ça)"; col = var(--success); }
            else if (bmi < 30) { desc = "Nadwaga"; col = var(--warning); }
            else { desc = "Oty≈Ço≈õƒá"; col = var(--danger); }
        } else {
            const age = parseInt(document.getElementById('bmi-age-val').value);
            const gender = document.getElementById('bmi-gender').value;
            // Mapowanie uproszczonych prog√≥w 85th/95th centyla WHO dla dzieci 5-19 lat
            // Dane te sƒÖ zr√≥≈ºnicowane - skrypt wybiera progi dynamicznie
            let p85 = (gender === 'male') ? (15 + (age * 0.6)) : (14.5 + (age * 0.7));
            let p95 = p85 + 3;

            if (bmi < 14) { desc = "Poni≈ºej 5. centyla (Wychudzenie)"; col = "#3182ce"; }
            else if (bmi < p85) { desc = "W normie centylowej"; col = "var(--success)"; }
            else if (bmi < p95) { desc = "Nadwaga (Powy≈ºej 85. centyla)"; col = "var(--warning)"; }
            else { desc = "Oty≈Ço≈õƒá (Powy≈ºej 95. centyla)"; col = "var(--danger)"; }
            desc += ` (Wiek: ${age} lat)`;
        }
        show('res-bmi', bmi, desc, col);
    }

    /* 2. WHR */
    function calculateWHR() {
        const w = parseFloat(document.getElementById('whr-waist').value);
        const h = parseFloat(document.getElementById('whr-hip').value);
        const g = document.getElementById('whr-gender').value;
        if (!w || !h) return;
        const whr = (w/h).toFixed(2);
        let risk = (g === 'm' ? whr > 0.9 : whr > 0.85);
        show('res-whr', whr, risk ? "Typ Jab≈Çko - Ryzyko metaboliczne" : "Typ Gruszka - Rozk≈Çad prawid≈Çowy", risk ? 'var(--danger)' : 'var(--success)');
    }

    /* 3. BMR (MIFFLIN-ST JEOR) */
    function calculateBMR() {
        const w = parseFloat(document.getElementById('bmr-weight').value);
        const h = parseFloat(document.getElementById('bmr-height').value);
        const a = parseFloat(document.getElementById('bmr-age').value);
        const g = document.getElementById('bmr-gender').value;
        if (!w || !h || !a) return;
        let bmr = (10 * w) + (6.25 * h) - (5 * a);
        bmr = (g === 'm') ? bmr + 5 : bmr - 161;
        show('res-bmr', Math.round(bmr) + " kcal", "Podstawowa przemiana materii (spoczynkowa)", "var(--primary)");
    }

    /* 4. PULSOMETR */
    let taps = [];
    function handleTap() {
        const now = Date.now();
        if (taps.length > 0 && now - taps[taps.length - 1] > 2000) taps = [];
        taps.push(now);
        document.getElementById('tap-count').innerText = "Taps: " + taps.length;
        if (taps.length > 1) {
            const duration = (taps[taps.length-1] - taps[0]) / 1000; // sekundy
            const bpm = Math.round(((taps.length - 1) / duration) * 60);
            document.getElementById('bpm-display').innerText = bpm + " BPM";
        }
    }
    function resetPulse() { taps = []; document.getElementById('bpm-display').innerText = "-- BPM"; document.getElementById('tap-count').innerText = "Taps: 0"; }

    /* 5. WHtR */
    function calculateWHtR() {
        const w = parseFloat(document.getElementById('whtr-waist').value);
        const h = parseFloat(document.getElementById('whtr-height').value);
        if (!w || !h) return;
        const ratio = (w / h).toFixed(2);
        const ok = ratio <= 0.5;
        show('res-whtr', ratio, ok ? "Prawid≈Çowy stosunek talii do wzrostu" : "Zwiƒôkszone ryzyko chor√≥b serca", ok ? 'var(--success)' : 'var(--danger)');
    }

    /* 6. WODA */
    function calculateWater() {
        const w = parseFloat(document.getElementById('h2o-weight').value);
        const act = parseFloat(document.getElementById('h2o-act').value);
        if (!w) return;
        const total = (w * 35) + ((act / 30) * 350);
        show('res-h2o', Math.round(total) + " ml", "Zalecane dobowe spo≈ºycie p≈Çyn√≥w", "#3182ce");
    }

    /* 7. RUFFIER */
    let timerInt;
    function startRuffierTimer(sec) {
        clearInterval(timerInt);
        const display = document.getElementById('r-timer');
        let timeLeft = sec;
        timerInt = setInterval(() => {
            timeLeft--;
            display.innerText = `00:${timeLeft < 10 ? '0' : ''}${timeLeft}`;
            if (timeLeft <= 0) clearInterval(timerInt);
        }, 1000);
    }
    function calculateRuffier() {
        const p1 = parseFloat(document.getElementById('r-p1').value);
        const p2 = parseFloat(document.getElementById('r-p2').value);
        const p3 = parseFloat(document.getElementById('r-p3').value);
        if (!p1 || !p2 || !p3) return;
        const index = ((p1 + p2 + p3) - 200) / 10;
        let msg = "";
        if (index <= 0) msg = "Wspania≈Ça wydolno≈õƒá";
        else if (index <= 5) msg = "Dobra wydolno≈õƒá";
        else if (index <= 10) msg = "≈örednia wydolno≈õƒá";
        else msg = "S≈Çaba wydolno≈õƒá - skonsultuj siƒô z lekarzem";
        show('res-ruffier', index.toFixed(1), msg, index <= 5 ? 'var(--success)' : 'var(--warning)');
    }
</script>

</body>
</html>
