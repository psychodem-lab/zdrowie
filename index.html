<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" type="image/png" href="cbt.png" />
    <title>Szlachetne Zdrowie</title>
    <style>
        .logo-wrapper a {
            text-decoration: none;
            border: none;
        }

        .logo-wrapper img {
            max-height: 100px; 
            width: auto;
            display: inline-block;
            margin-top: 0; 
            border: 0;
        }
        :root {
            /* Paleta kolor贸w - Clinical Clean */
            --primary: #0081a7; 
            --primary-dark: #005f73;
            --accent: #00afb9;
            --bg: #fdfcdc;
            --bg-gradient: linear-gradient(135deg, #fdfbf7 0%, #eef2f3 100%);
            --card-bg: rgba(255, 255, 255, 0.95);
            --text-main: #2b2d42;
            --text-muted: #8d99ae;
            --success: #38b000;
            --warning: #ffaa00;
            --danger: #d00000;
            
            --radius: 16px;
            --shadow: 0 10px 30px -5px rgba(0, 0, 0, 0.05);
            --border: 1px solid rgba(0,0,0,0.05);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background: var(--bg-gradient);
            color: var(--text-main);
            line-height: 1.5;
            padding: 40px 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
        }

        /* Header */
        header {
            text-align: center;
            margin-bottom: 60px;
        }

        header h1 {
            font-weight: 800;
            font-size: 3rem;
            background: -webkit-linear-gradient(var(--primary-dark), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        header p {
            color: var(--text-muted);
            font-size: 1.1rem;
        }

        /* Grid System */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
        }

        /* Cards */
        .card {
            background: var(--card-bg);
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow);
            border: var(--border);
            backdrop-filter: blur(10px);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            display: flex;
            flex-direction: column;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px -5px rgba(0, 0, 0, 0.1);
        }

        .card-header {
            margin-bottom: 20px;
            border-bottom: 1px solid #f0f0f0;
            padding-bottom: 15px;
        }

        .card h2 {
            font-size: 1.2rem;
            color: var(--primary-dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-icon {
            font-size: 1.4rem;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 15px;
        }

        .form-row {
            display: flex;
            gap: 10px;
        }

        label {
            display: block;
            margin-bottom: 6px;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        input, select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            background: #fafafa;
            transition: all 0.2s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            background: #fff;
            box-shadow: 0 0 0 3px rgba(0, 129, 167, 0.1);
        }

        button {
            width: 100%;
            padding: 14px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
            margin-top: auto; /* Push to bottom if flex container */
        }

        button:hover {
            background-color: var(--primary-dark);
        }

        button.outline {
            background: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
            margin-top: 10px;
        }

        button.outline:hover {
            background: rgba(0, 129, 167, 0.05);
        }

        /* Results Area */
        .result-box {
            margin-top: 20px;
            padding: 15px;
            background: #f8fdff;
            border-radius: 8px;
            border-left: 4px solid var(--accent);
            display: none;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-value {
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--text-main);
            line-height: 1.2;
        }

        .result-label {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-top: 5px;
        }

        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: bold;
            color: #fff;
            margin-left: 10px;
            vertical-align: middle;
        }

        /* Specyficzne dla Pulsometru */
        #tap-area {
            height: 100px;
            border: 2px dashed #cbd5e1;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            user-select: none;
            margin-bottom: 15px;
            background: #f8fafc;
            color: var(--text-muted);
            transition: all 0.1s;
        }
        #tap-area:active {
            background: #e2e8f0;
            border-color: var(--primary);
            transform: scale(0.98);
        }

        /* Specyficzne dla Ruffiera */
        .timer-display {
            font-family: monospace;
            font-size: 2rem;
            text-align: center;
            margin: 10px 0;
            color: var(--primary-dark);
        }
        
        /* Footer */
        footer {
            margin-top: 60px;
            text-align: center;
            font-size: 0.85rem;
            color: var(--text-muted);
            border-top: 1px solid rgba(0,0,0,0.05);
            padding-top: 30px;
        }
    </style>
    <body>
    <div class="logo-wrapper">
            <a href="https://psychodem-lab.github.io/CBT/Biblioteka" title="Powr贸t do strony g贸wnej">
                <img src="logo.png" alt="Logo Psychodem">
            </a>
        </div>
</head>
<body>

<div class="container">
    <header>
        <h1>Szlachetne Zdrowie</h1>
        <p>Precyzyjne algorytmy. Czyste dane. zero domys贸w.</p>
    </header>

    <div class="grid">
        
        <div class="card">
            <div class="card-header">
                <h2><span class="card-icon">锔</span> BMI</h2>
            </div>
            <div class="form-group">
                <label>Waga (kg)</label>
                <input type="number" id="bmi-weight" placeholder="np. 75">
            </div>
            <div class="form-group">
                <label>Wzrost (cm)</label>
                <input type="number" id="bmi-height" placeholder="np. 180">
            </div>
            <button onclick="calcBMI()">Oblicz BMI</button>
            <div id="res-bmi" class="result-box"></div>
        </div>

        <div class="card">
            <div class="card-header">
                <h2><span class="card-icon"></span> WHR (Talia/Biodra)</h2>
            </div>
            <div class="form-group">
                <label>Pe</label>
                <select id="whr-gender">
                    <option value="m">M偶czyzna</option>
                    <option value="k">Kobieta</option>
                </select>
            </div>
            <div class="form-group">
                <label>Obw贸d talii (cm)</label>
                <input type="number" id="whr-waist" placeholder="W najw偶szym miejscu">
            </div>
            <div class="form-group">
                <label>Obw贸d bioder (cm)</label>
                <input type="number" id="whr-hip" placeholder="W najszerszym miejscu">
            </div>
            <button onclick="calcWHR()">Analizuj sylwetk</button>
            <div id="res-whr" class="result-box"></div>
        </div>

        <div class="card">
            <div class="card-header">
                <h2><span class="card-icon"></span> WHtR (Talia/Wzrost)</h2>
            </div>
            <div class="form-group">
                <label>Obw贸d talii (cm)</label>
                <input type="number" id="whtr-waist" placeholder="np. 80">
            </div>
            <div class="form-group">
                <label>Wzrost (cm)</label>
                <input type="number" id="whtr-height" placeholder="np. 180">
            </div>
            <button onclick="calcWHtR()">Sprawd藕 ryzyko metaboliczne</button>
            <div id="res-whtr" class="result-box"></div>
        </div>

        <div class="card">
            <div class="card-header">
                <h2><span class="card-icon"></span> BMR (Mifflin-St Jeor)</h2>
            </div>
            <div class="form-row">
                <div class="form-group" style="flex:1">
                    <label>Pe</label>
                    <select id="bmr-gender">
                        <option value="m">M</option>
                        <option value="k">K</option>
                    </select>
                </div>
                <div class="form-group" style="flex:1">
                    <label>Wiek</label>
                    <input type="number" id="bmr-age" placeholder="Lat">
                </div>
            </div>
            <div class="form-row">
                <div class="form-group" style="flex:1">
                    <label>Waga (kg)</label>
                    <input type="number" id="bmr-weight">
                </div>
                <div class="form-group" style="flex:1">
                    <label>Wzrost (cm)</label>
                    <input type="number" id="bmr-height">
                </div>
            </div>
            <button onclick="calcBMR()">Oblicz zapotrzebowanie</button>
            <div id="res-bmr" class="result-box"></div>
        </div>

        <div class="card">
            <div class="card-header">
                <h2><span class="card-icon">わ</span> Pulsometr (Tap)</h2>
            </div>
            <div id="tap-area" onclick="handleTap()">
                Klikaj zgodnie z twoim ttnem na szyi
            </div>
            <div class="result-value" id="bpm-display" style="text-align:center; margin-bottom:10px;">-- BPM</div>
            <button class="outline" onclick="resetPulse()">Reset</button>
        </div>

        <div class="card">
            <div class="card-header">
                <h2><span class="card-icon"></span> Woda</h2>
            </div>
            <div class="form-group">
                <label>Waga (kg)</label>
                <input type="number" id="water-weight">
            </div>
            <div class="form-group">
                <label>Aktywno fizyczna (min)</label>
                <input type="number" id="water-active" value="0">
            </div>
            <button onclick="calcWater()">Oblicz</button>
            <div id="res-water" class="result-box"></div>
        </div>

        <div class="card" style="grid-column: 1 / -1;">
            <div class="card-header">
                <h2><span class="card-icon"></span> Test Ruffiera (Wydolno serca)</h2>
            </div>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                <div>
                    <p style="font-size:0.9rem; color:var(--text-muted); margin-bottom:10px;">
                        <strong>Procedura:</strong><br>
                        1. Zmierz ttno spoczynkowe (P1).<br>
                        2. Wykonaj 30 przysiad贸w w 60 sekund.<br>
                        3. Zmierz ttno od razu po wysiku (P2).<br>
                        4. Odpocznij 1 minut i zmierz ttno (P3).
                    </p>
                    <div class="timer-display" id="ruffier-timer">00:00</div>
                    <button class="outline" onclick="startRuffierTimer('exercise')">Stoper: wiczenie (60s)</button>
                    <button class="outline" onclick="startRuffierTimer('rest')">Stoper: Odpoczynek (60s)</button>
                </div>
                <div>
                    <div class="form-group">
                        <label>P1 (Spoczynek)</label>
                        <input type="number" id="p1">
                    </div>
                    <div class="form-group">
                        <label>P2 (Po wysiku)</label>
                        <input type="number" id="p2">
                    </div>
                    <div class="form-group">
                        <label>P3 (Po 1 minucie)</label>
                        <input type="number" id="p3">
                    </div>
                    <button onclick="calcRuffier()">Oblicz Indeks Ruffiera</button>
                </div>
            </div>
            <div id="res-ruffier" class="result-box"></div>
        </div>

    </div>

    <footer>
        <p><strong>Nota prawna:</strong> Wszystkie obliczenia oparte s na powszechnie uznanych wzorach medycznych. Aplikacja nie zbiera danych (dziaa lokalnie). Wyniki maj charakter pogldowy i nie zastpuj diagnozy lekarskiej.</p>
    </footer>
</div>

<script>
    /* --- HELPERY --- */
    function showResult(elementId, valueHtml, descHtml, color = 'var(--text-main)') {
        const box = document.getElementById(elementId);
        box.style.display = 'block';
        box.style.borderLeftColor = color;
        box.innerHTML = `<div class="result-value" style="color:${color}">${valueHtml}</div><div class="result-label">${descHtml}</div>`;
    }

    function getVal(id) {
        const v = parseFloat(document.getElementById(id).value);
        return isNaN(v) ? 0 : v;
    }

    /* --- 1. BMI --- */
    function calcBMI() {
        const w = getVal('bmi-weight');
        const h = getVal('bmi-height') / 100; // cm to m
        if (w <= 0 || h <= 0) return alert("Podaj poprawne dane");

        const bmi = (w / (h * h)).toFixed(2);
        let desc = "", col = "";

        if (bmi < 18.5) { desc = "Niedowaga"; col = "var(--primary)"; }
        else if (bmi < 25) { desc = "Norma"; col = "var(--success)"; }
        else if (bmi < 30) { desc = "Nadwaga"; col = "var(--warning)"; }
        else { desc = "Otyo"; col = "var(--danger)"; }

        showResult('res-bmi', bmi, `Kategoria: ${desc}`, col);
    }

    /* --- 2. WHR --- */
    function calcWHR() {
        const waist = getVal('whr-waist');
        const hip = getVal('whr-hip');
        const gender = document.getElementById('whr-gender').value;
        if (waist <= 0 || hip <= 0) return alert("Podaj poprawne dane");

        const whr = (waist / hip).toFixed(2);
        let type = "Typ: Gruszka (Bezpieczny)";
        let risk = false;

        // Limity otyoci brzusznej wg WHO
        if (gender === 'm' && whr >= 0.90) risk = true;
        if (gender === 'k' && whr >= 0.85) risk = true;

        if (risk) type = "Typ: Jabko (Ryzyko otyoci trzewnej)";
        
        showResult('res-whr', whr, type, risk ? 'var(--danger)' : 'var(--success)');
    }

    /* --- 3. WHtR --- */
    function calcWHtR() {
        const w = getVal('whtr-waist');
        const h = getVal('whtr-height');
        if (w <= 0 || h <= 0) return alert("Podaj poprawne dane");

        const whtr = (w / h).toFixed(2);
        let desc = "", col = "";

        if (whtr <= 0.5) { desc = "Zdrowy poziom"; col = "var(--success)"; }
        else if (whtr <= 0.6) { desc = "Podwy偶szone ryzyko"; col = "var(--warning)"; }
        else { desc = "Wysokie ryzyko metaboliczne"; col = "var(--danger)"; }

        showResult('res-whtr', whtr, `Interpretacja: ${desc}`, col);
    }

    /* --- 4. BMR (Mifflin-St Jeor) --- */
    function calcBMR() {
        const w = getVal('bmr-weight');
        const h = getVal('bmr-height');
        const age = getVal('bmr-age');
        const gender = document.getElementById('bmr-gender').value;

        if (w <= 0 || h <= 0 || age <= 0) return alert("Wypenij wszystkie pola");

        // Wz贸r Mifflina-St Jeora
        let bmr = (10 * w) + (6.25 * h) - (5 * age);
        if (gender === 'm') bmr += 5;
        else bmr -= 161;

        showResult('res-bmr', `${Math.round(bmr)} kcal`, "Podstawowa przemiana materii (spoczynek)", "var(--primary-dark)");
    }

    /* --- 5. WODA --- */
    function calcWater() {
        const w = getVal('water-weight');
        const act = getVal('water-active');
        if (w <= 0) return alert("Podaj wag");

        let needs = w * 30; // baza
        if (act > 0) needs += (act / 30) * 350; // dodatek treningowy

        showResult('res-water', `${Math.round(needs)} ml`, "Dzienne zapotrzebowanie pyn贸w", "#3498db");
    }

    /* --- 6. PULS (TAP) --- */
    let taps = [];
    function handleTap() {
        const now = Date.now();
        if (taps.length > 0 && now - taps[taps.length - 1] > 2000) taps = []; // Reset po 2s przerwy
        taps.push(now);
        if (taps.length > 10) taps.shift(); // Keep last 10

        if (taps.length > 1) {
            let intervals = [];
            for (let i = 1; i < taps.length; i++) intervals.push(taps[i] - taps[i-1]);
            const avg = intervals.reduce((a, b) => a + b) / intervals.length;
            const bpm = Math.round(60000 / avg);
            document.getElementById('bpm-display').innerText = bpm + " BPM";
        }
    }
    function resetPulse() {
        taps = [];
        document.getElementById('bpm-display').innerText = "-- BPM";
    }

    /* --- 7. RUFFIER --- */
    let timerInterval;
    function startRuffierTimer(mode) {
        clearInterval(timerInterval);
        let seconds = (mode === 'exercise') ? 60 : 60;
        const display = document.getElementById('ruffier-timer');
        
        display.innerText = `00:${seconds}`;
        display.style.color = 'var(--primary)';

        timerInterval = setInterval(() => {
            seconds--;
            display.innerText = `00:${seconds < 10 ? '0'+seconds : seconds}`;
            
            if (seconds <= 0) {
                clearInterval(timerInterval);
                display.innerText = "KONIEC";
                display.style.color = 'var(--danger)';
                // Prosty beep (opcjonalny, mo偶e nie dziaa bez interakcji w niekt贸rych przegldarkach)
                // const audio = new AudioContext(); // skipped to keep simple
            }
        }, 1000);
    }

    function calcRuffier() {
        const p1 = getVal('p1');
        const p2 = getVal('p2');
        const p3 = getVal('p3');

        if (p1 <= 0 || p2 <= 0 || p3 <= 0) return alert("Wprowad藕 wszystkie 3 pomiary ttna");

        // Wz贸r Ruffiera
        const index = ((p1 + p2 + p3) - 200) / 10;
        let desc = "", col = "";

        if (index <= 0) { desc = "Wydolno: Wybitna"; col = "var(--success)"; }
        else if (index <= 5) { desc = "Wydolno: Bardzo dobra"; col = "#80b918"; }
        else if (index <= 10) { desc = "Wydolno: Przecitna"; col = "var(--warning)"; }
        else if (index <= 15) { desc = "Wydolno: Saba"; col = "#e76f51"; }
        else { desc = "Wydolno: Bardzo saba"; col = "var(--danger)"; }

        showResult('res-ruffier', index.toFixed(1), desc, col);
    }
</script>

</body>
</html>
